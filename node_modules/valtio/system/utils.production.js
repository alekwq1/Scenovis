System.register(["valtio/vanilla","proxy-compare"],function(M){"use strict";var O,y,S,T,C,D,A;return{setters:[function(p){O=p.subscribe,y=p.snapshot,S=p.proxy,T=p.getVersion,C=p.ref},function(p){D=p.createProxy,A=p.isChanged}],execute:function(){M({addComputed:U,derive:W,devtools:z,proxyMap:$,proxySet:X,proxyWithComputed:V,proxyWithHistory:K,subscribeKey:p,underive:L,watch:H});function p(r,n,e,t){return O(r,s=>{s.some(a=>a[1][0]===n)&&e(r[n])},t)}let g;function H(r,n){let e=!0;const t=new Set,s=new Map,a=()=>{e&&(e=!1,t.forEach(o=>o()),t.clear(),s.forEach(o=>o()),s.clear())},u=()=>{if(!e)return;t.forEach(i=>i()),t.clear();const o=new Set,f=g;g=t;try{const i=r(c=>(o.add(c),c));i&&t.add(i)}finally{g=f}s.forEach((i,c)=>{o.has(c)?o.delete(c):(s.delete(c),i())}),o.forEach(i=>{const c=O(i,u,n==null?void 0:n.sync);s.set(i,c)})};return g&&g.add(a),u(),a}const P=Symbol();function z(r,n){typeof n=="string"&&(console.warn("[Deprecated] Please use option object instead of name string"),n={name:n});const{enabled:e,name:t=""}=n||{};let s;try{s=(e!=null?e:!1)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!s)return;let a=!1;const u=s.connect({name:t}),o=O(r,i=>{const c=i.filter(([l,h])=>h[0]!==P).map(([l,h])=>`${l}:${h.map(String).join(".")}`).join(", ");if(!!c)if(a)a=!1;else{const l=Object.assign({},y(r));delete l[P],u.send({type:c,updatedAt:new Date().toLocaleString()},l)}}),f=u.subscribe(i=>{var c,l,h,d,v,m;if(i.type==="ACTION"&&i.payload)try{Object.assign(r,JSON.parse(i.payload))}catch(b){console.error(`please dispatch a serializable value that JSON.parse() and proxy() support
`,b)}if(i.type==="DISPATCH"&&i.state){if(((c=i.payload)==null?void 0:c.type)==="JUMP_TO_ACTION"||((l=i.payload)==null?void 0:l.type)==="JUMP_TO_STATE"){a=!0;const b=JSON.parse(i.state);Object.assign(r,b)}r[P]=i}else if(i.type==="DISPATCH"&&((h=i.payload)==null?void 0:h.type)==="COMMIT")u.init(y(r));else if(i.type==="DISPATCH"&&((d=i.payload)==null?void 0:d.type)==="IMPORT_STATE"){const b=(v=i.payload.nextLiftedState)==null?void 0:v.actionsById,x=((m=i.payload.nextLiftedState)==null?void 0:m.computedStates)||[];a=!0,x.forEach(({state:B},J)=>{const q=b[J]||"No action found";Object.assign(r,B),J===0?u.init(y(r)):u.send(q,y(r))})}});return u.init(y(r)),()=>{o(),f==null||f()}}const E=new WeakMap,w=new WeakMap,I=(r,n)=>{const e=E.get(r);e&&(e[0].forEach(t=>{const{d:s}=t;r!==s&&I(s)}),++e[2],n&&e[3].add(n))},R=(r,n)=>{const e=E.get(r);return e!=null&&e[2]?(e[3].add(n),!0):!1},_=r=>{const n=E.get(r);n&&(--n[2],n[2]||(n[3].forEach(e=>e()),n[3].clear()),n[0].forEach(e=>{const{d:t}=e;r!==t&&_(t)}))},N=r=>{const{s:n,d:e}=r;let t=w.get(e);t||(t=[new Set],w.set(r.d,t)),t[0].add(r);let s=E.get(n);if(!s){const a=new Set,u=O(n,o=>{a.forEach(f=>{const{d:i,c,n:l,i:h}=f;n===i&&o.every(d=>d[1].length===1&&h.includes(d[1][0]))||f.p||(I(n,c),l?_(n):f.p=Promise.resolve().then(()=>{delete f.p,_(n)}))})},!0);s=[a,u,0,new Set],E.set(n,s)}s[0].add(r)},j=r=>{const{s:n,d:e}=r,t=w.get(e);t==null||t[0].delete(r),(t==null?void 0:t[0].size)===0&&w.delete(e);const s=E.get(n);if(s){const[a,u]=s;a.delete(r),a.size||(u(),E.delete(n))}},k=r=>{const n=w.get(r);return n?Array.from(n[0]):[]},G=M("unstable_deriveSubscriptions",{add:N,remove:j,list:k});function W(r,n){const e=(n==null?void 0:n.proxy)||S({}),t=!!(n!=null&&n.sync),s=Object.keys(r);return s.forEach(a=>{if(Object.getOwnPropertyDescriptor(e,a))throw new Error("object property already defined");const u=r[a];let o=null;const f=()=>{if(o&&(Array.from(o).map(([d])=>R(d,f)).some(d=>d)||Array.from(o).every(([d,v])=>T(d)===v.v)))return;const i=new Map,l=u(d=>(i.set(d,{v:T(d)}),d)),h=()=>{i.forEach((d,v)=>{var m;const b=(m=o==null?void 0:o.get(v))==null?void 0:m.s;if(b)d.s=b;else{const x={s:v,d:e,k:a,c:f,n:t,i:s};N(x),d.s=x}}),o==null||o.forEach((d,v)=>{!i.has(v)&&d.s&&j(d.s)}),o=i};l instanceof Promise?l.finally(h):h(),e[a]=l};f()}),e}function L(r,n){const e=n!=null&&n.delete?new Set:null;k(r).forEach(t=>{const{k:s}=t;(!(n!=null&&n.keys)||n.keys.includes(s))&&(j(t),e&&e.add(s))}),e&&e.forEach(t=>{delete r[t]})}function U(r,n,e=r){console.warn("addComputed is deprecated. Please consider using `derive` or `proxyWithComputed` instead. Falling back to emulation with derive.");const t={};return Object.keys(n).forEach(s=>{t[s]=a=>n[s](a(r))}),W(t,{proxy:e})}function V(r,n){Object.keys(n).forEach(t=>{if(Object.getOwnPropertyDescriptor(r,t))throw new Error("object property already defined");const s=n[t],{get:a,set:u}=typeof s=="function"?{get:s}:s;let o,f,i=new WeakMap;const c={};c.get=()=>{const l=y(e);return(!f||A(f,l,i))&&(i=new WeakMap,o=a(D(l,i)),f=l),o},u&&(c.set=l=>u(e,l)),Object.defineProperty(r,t,c)});const e=S(r);return e}function K(r,n=!1){const e=S({value:r,history:C({wip:r,snapshots:[],index:-1}),canUndo:()=>e.history.index>0,undo:()=>{e.canUndo()&&(e.value=e.history.wip=e.history.snapshots[--e.history.index],e.history.snapshots[e.history.index]=y(e).value)},canRedo:()=>e.history.index<e.history.snapshots.length-1,redo:()=>{e.canRedo()&&(e.value=e.history.wip=e.history.snapshots[++e.history.index],e.history.snapshots[e.history.index]=y(e).value)},saveHistory:()=>{e.history.snapshots.splice(e.history.index+1),e.history.snapshots.push(y(e).value),++e.history.index},subscribe:()=>O(e,t=>{t.every(s=>s[1][0]==="value"&&(s[0]!=="set"||s[2]!==e.history.wip))&&e.saveHistory()})});return e.saveHistory(),n||e.subscribe(),e}function X(r){const n=S({data:Array.from(new Set(r)),has(e){return this.data.indexOf(e)!==-1},add(e){let t=!1;return typeof e=="object"&&e!==null&&(t=this.data.indexOf(S(e))!==-1),this.data.indexOf(e)===-1&&!t&&this.data.push(e),this},delete(e){const t=this.data.indexOf(e);return t===-1?!1:(this.data.splice(t,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},forEach(e){this.data.forEach(t=>{e(t,t,this)})},get[Symbol.toStringTag](){return"Set"},toJSON(){return{}},[Symbol.iterator](){return this.data[Symbol.iterator]()},values(){return this.data.values()},keys(){return this.data.values()},entries(){return new Set(this.data).entries()}});return Object.defineProperties(n,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(n),n}function $(r){const n=S({data:Array.from(r||[]),has(e){return this.data.some(t=>t[0]===e)},set(e,t){const s=this.data.find(a=>a[0]===e);return s?s[1]=t:this.data.push([e,t]),this},get(e){var t;return(t=this.data.find(s=>s[0]===e))==null?void 0:t[1]},delete(e){const t=this.data.findIndex(s=>s[0]===e);return t===-1?!1:(this.data.splice(t,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},toJSON(){return{}},forEach(e){this.data.forEach(t=>{e(t[1],t[0],this)})},keys(){return this.data.map(e=>e[0]).values()},values(){return this.data.map(e=>e[1]).values()},entries(){return new Map(this.data).entries()},get[Symbol.toStringTag](){return"Map"},[Symbol.iterator](){return this.entries()}});return Object.defineProperties(n,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(n),n}}}});
